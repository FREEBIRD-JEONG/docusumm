# DocuSumm Product Requirements Document (PRD)

## 목표 및 배경 컨텍스트

### 목표

- 다양한 콘텐츠(텍스트, YouTube 영상)를 AI가 자동으로 요약해주는 고품질 유틸리티 SaaS 개발
- 글로벌 사용자를 타겟으로 한 해외 결제 시스템 및 이메일 자동화 구축
- 실제 수익화가 가능한 수준의 완성도 높은 서비스 구현

### 배경 컨텍스트

현대 사용자는 텍스트, PDF 문서, 영상 등 방대한 양의 정보에 노출되어 있으며, 이를 효율적으로 소비하고자 하는 니즈가 강함. DocuSumm은 AI 모델의 Long Context 강점을 활용하여 다양한 포맷의 자료를 빠르고 정확하게 요약해주는 서비스를 제공함으로써 생산성을 높이고자 함. 또한 글로벌 결제 및 알림 시스템을 통합하여 실제 운영 가능한 SaaS 모델을 검증하는 것을 목표로 함.

---

## 요구사항

### 기능 요구사항 (Functional Requirements)

#### 인증 (Authentication)

- **FR001**: 사용자는 소셜 로그인(Google 등)을 통해 가입 및 로그인할 수 있어야 한다.
- **FR002**: 로그인하지 않은 사용자는 서비스의 주요 기능(요약, 히스토리 등)에 접근할 수 없어야 한다 (Protected Routes).
- **FR003**: 신규 가입 사용자에게는 **3 크레딧(요약 3회 분량)**의 무료 크레딧이 자동으로 지급되어야 한다.

#### 문서 관리 (Document Management)

- **FR004**: 사용자는 자신의 과거 요약 요청 목록(History)을 날짜별로 조회할 수 있어야 한다.

#### AI 요약 (AI Summarization)

- **FR005**: 사용자는 직접 텍스트를 입력하거나, YouTube 영상 URL을 입력하여 요약을 요청할 수 있어야 한다.
- **FR006**: 시스템은 AI 모델을 활용하여 입력된 콘텐츠(긴 텍스트 포함)를 요약해야 한다.
- **FR007**: 요약 요청 1회당 **1 크레딧**을 차감하며, 잔액 부족 시 요청을 거부해야 한다.
- **FR008**: 요약 작업은 시간이 소요될 수 있으므로 백그라운드에서 비동기적으로 처리되어야 한다.

#### 이메일 자동화 (Email Automation)

- **FR009**: 요약이 완료되면 시스템은 사용자에게 "요약 완료 알림" 이메일을 자동으로 발송해야 한다.
- **FR010**: 이메일에는 요약 결과 페이지로 바로 이동할 수 있는 링크가 포함되어야 한다.

#### 해외 결제 (Global Payment)

- **FR011**: 사용자는 글로벌 결제 서비스를 통해 **30 크레딧($5), 50 크레딧($8), 100 크레딧($15)** 단위 등 패키지로 크레딧을 충전할 수 있어야 한다.
- **FR012**: 결제가 완료되면 해당 금액만큼의 크레딧이 사용자 계정에 즉시 충전되어야 한다.

### 비기능 요구사항 (Non-Functional Requirements)

- **NFR001**: 사용자 데이터(요약본)는 철저히 격리되어 본인만 접근 가능해야 한다.
- **NFR002**: 글로벌 결제 테스트를 위해 결제 서비스의 Test 모드와 Production 모드를 환경 변수로 분리하여 관리해야 한다.

---

## 사용자 여정 (User Journeys)

### 여정 1: 신규 사용자 요약 요청 및 결과 확인

1. 사용자가 메인 페이지(대시보드)에 접속하여 바로 텍스트를 입력하거나 YouTube URL을 붙여넣는다.
2. "요약하기" 버튼을 클릭한다.
3. (로그인하지 않은 경우) 로그인 모달이 뜨고 구글 소셜 로그인을 진행한다.
4. 로그인 완료 시 자동으로 요약 요청이 시작되며, 신규 가입 보너스 크레딧이 차감된다.
5. "요약이 시작되었습니다. 완료되면 이메일로 알려드립니다"라는 메시지를 확인한다.
6. 잠시 후, 가입한 이메일로 "DocuSumm: 요약이 완료되었습니다"라는 메일을 수신하고 결과를 확인한다.

### 여정 2: 크레딧 충전 (Pay-as-you-go)

1. 무료 크레딧을 모두 소진한 사용자가 추가 요약을 시도한다.
2. "크레딧이 부족합니다. 추가 크레딧을 충전하세요"라는 모달이 표시된다.
3. 사용자는 사이드바 하단 또는 알림 내 "충전하기" 버튼을 클릭한다.
4. 화면 중앙에 **크레딧 충전 모달(Dialog)**이 팝업된다.
5. 원하는 크레딧 패키지(예: 30회분 $5, 50회분 $8, 100회분 $15) 카드의 "구매하기" 버튼을 클릭한다.
6. Stripe 결제 페이지로 리다이렉션되어 결제를 진행한다.
7. 결제 성공 후 대시보드로 복귀하며, 우측 상단 토스트 메시지로 "충전 완료" 알림을 받는다.

---

## UX 디자인 원칙

### 핵심 원칙

- **Simplicity (단순성)**: 별도의 시작 버튼 없이 메인 화면에서 즉시 입력이 가능해야 한다.
- **Feedback (피드백)**: 비동기 작업의 특성상, 작업 시작/진행/완료 상태를 사용자에게 명확히 인지시켜야 한다.
- **Focus (집중)**: 요약 결과 화면은 텍스트 가독성을 최우선으로 하여 불필요한 요소를 배제한다.
- **Trust (신뢰)**: 결제 및 개인 문서 처리 과정에서 보안과 안전함을 시각적으로 전달해야 한다.

### 플랫폼 및 화면

- **플랫폼**: 데스크톱 웹 (반응형 지원)
- **핵심 화면**:
  - 대시보드 (메인 페이지, 입력 패널 통합)
  - 요약 상세 보기 (Markdown 렌더링)
  - 결제 및 설정 페이지

### 디자인 제약사항

- AI 모델의 응답 시간에 따라 로딩 상태가 길어질 수 있음을 고려한 UI 설계 필요 (스켈레톤 UI 등)
- 유튜브 요약의 경우 썸네일 및 영상 메타데이터를 함께 표시하여 시각적 매력도 증대

---

## UI 디자인 목표

### 주요 UI 요소

1. **입력 패널 (Input Panel)**
   - 메인 화면 중앙에 위치 (Lading Page와 Dashboard 통합)
   - 탭 기반 인터페이스 (Text / YouTube)
   - URL 유효성 검사 및 실시간 피드백

2. **요약 결과 카드 (Summary Card)**
   - 핵심 내용 3줄 요약 (TL;DR) 섹션 강조
   - 마크다운 스타일링이 적용된 본문 텍스트
   - 복사하기, 공유하기 버튼 배치

3. **히스토리 리스트 (Sidebar History)**
   - 좌측 사이드바에 배치 (ChatGPT 스타일)
   - 날짜별 그룹핑 및 요약 제목 리스트
   - 클릭 시 우측 메인 영역에 해당 요약 결과 로드

4. **크레딧 충전 모달 (Credit Top-up Dialog)**
   - "충전하기" 버튼 클릭 시 호출되는 오버레이 컴포넌트
   - 3가지 가격 정책(Pricing Cards)을 카드 형태로 나열
   - 현재 페이지 이탈 없이 결제 프로세스 시작 (Stripe Redirect 전 단계)


### 인터랙션 패턴

- 사이드바 접기/펼치기 (Collapsible Sidebar)
- 긴 텍스트 입력 시 자동 높이 조절 (Auto-resize)
- 결제 진행 시 오버레이 모달 사용
- 토스트 메시지(Toast)를 활용한 상태 알림

---

## Epic 목록

### 진행 현황 스냅샷 (기준일: 2026-02-20)

- Epic 1: **4/4 스토리 완료** (기존 3개 + UI 현대화 리디자인 1개 반영)
- Epic 2: **4/4 스토리 및 운영/검증 체크 완료**
- Epic 3: **3/3 스토리 완료** (인증/히스토리 격리/관리)
- Epic 4: **3/4 스토리 완료** (`4.1` 진행 중: Stripe Webhook Endpoint 운영 검증 필요)
- Epic 5: 미착수

### Epic 1: UI/UX 프레임워크 개발 (UI Only)

- [x] 목표: 메인 대시보드, 사이드바, 입력 패널 등 핵심 화면의 퍼블리싱 및 반응형 UI 구현 (기능 제외)
- [x] 예상 스토리 수: 4 (기존 3 + UI 현대화 리디자인 반영)

#### Epic 1 체크리스트

- [x] E1-S1: 대시보드 레이아웃/내비게이션 셸 구축
- [x] E1-S1 User Story: 사용자는 화면 크기에 맞는 일관된 대시보드 레이아웃(사이드바 + 메인 영역)에서 핵심 기능에 빠르게 접근할 수 있어야 한다.
- [x] E1-S1 범위: 대시보드 기본 레이아웃(좌측 사이드바, 우측 콘텐츠 영역) 퍼블리싱
- [x] E1-S1 범위: 모바일/태블릿/데스크톱 반응형 브레이크포인트 대응
- [x] E1-S1 범위: 사이드바 접기/펼치기 UI 및 접근성 속성(`aria-*`) 적용
- [x] E1-S1 AC: 데스크톱(>=1024px)에서는 사이드바가 기본 노출되고 메인 콘텐츠가 겹치지 않는다.
- [x] E1-S1 AC: 모바일(<768px)에서는 사이드바가 오버레이 형태로 열리고 외부 클릭 또는 ESC로 닫힌다.
- [x] E1-S1 AC: 키보드만으로도 사이드바 열기/닫기와 주요 포커스 이동이 가능하다.
- [x] E1-S1 AC: 빈 상태(히스토리 없음)에서도 레이아웃 붕괴 없이 기본 안내 UI가 표시된다.

- [x] E1-S2: 입력 패널(Text/YouTube) UI 구현
- [x] E1-S2 User Story: 사용자는 텍스트 입력 또는 YouTube URL 입력 중 원하는 방식을 선택해 요약 요청을 준비할 수 있어야 한다.
- [x] E1-S2 범위: 탭 기반 입력 패널(Text / YouTube) 구현
- [x] E1-S2 범위: 텍스트 입력 자동 높이 조절(auto-resize) 적용
- [x] E1-S2 범위: YouTube URL 형식에 대한 클라이언트 유효성 피드백(UI 레벨) 제공
- [x] E1-S2 범위: 요약 버튼 활성/비활성 상태 및 helper text 표시
- [x] E1-S2 추가 반영: `youtu.be`, `youtube.com/watch`, `shorts`, `embed`, `live`, `m.youtube.com`, `music.youtube.com` URL 형식 정규화 지원
- [x] E1-S2 AC: 탭 전환 시 선택된 입력 모드가 즉시 시각적으로 구분된다.
- [x] E1-S2 AC: 텍스트 입력은 줄 수 증가에 따라 자연스럽게 높이가 확장된다.
- [x] E1-S2 AC: 유효하지 않은 YouTube URL 입력 시 즉시 오류 메시지가 노출된다.
- [x] E1-S2 AC: `www` 유무와 관계없이 유효한 YouTube URL 형식은 정상 인식된다.
- [x] E1-S2 AC: 입력값이 비어있거나 형식이 잘못된 경우 요약 버튼은 비활성화된다.

- [x] E1-S3: 요약 결과 카드/히스토리 리스트 목업 상호작용 구현
- [x] E1-S3 User Story: 사용자는 요약 결과가 어떤 형태로 제공되는지 미리 확인하고, 히스토리 클릭 시 결과가 전환되는 경험을 체감할 수 있어야 한다.
- [x] E1-S3 범위: `SummaryCard` 목업(TL;DR, 본문, 액션 버튼) 구현
- [x] E1-S3 범위: 좌측 히스토리 리스트 목업(날짜 그룹/제목 리스트) 구현
- [x] E1-S3 범위: 히스토리 항목 클릭 시 우측 결과 카드가 변경되는 클라이언트 상태 연동(Mock 데이터)
- [x] E1-S3 범위: 로딩/빈 상태/오류 상태용 시각 컴포넌트(스켈레톤, 경고 텍스트) 구현
- [x] E1-S3 추가 반영: 히스토리 URL 제목 가독성 개선(YouTube URL 원문 대신 읽기 쉬운 제목) 및 오버플로우(truncate) 처리
- [x] E1-S3 추가 반영: 요약 시간 표시를 UTC 고정 포맷으로 통일해 hydration mismatch 방지
- [x] E1-S3 AC: Mock 히스토리 항목 클릭 시 해당 Mock 요약 내용으로 카드가 즉시 전환된다.
- [x] E1-S3 AC: 결과 카드에는 TL;DR 섹션과 본문 영역이 구분되어 표시된다.
- [x] E1-S3 AC: 로딩 상태에서는 스켈레톤 UI가 표시되고, 완료 시 실제 카드로 전환된다.
- [x] E1-S3 AC: 히스토리 데이터가 없을 때 사용자 행동 유도 문구(예: 첫 요약 생성)가 노출된다.

- [x] E1-S4: 핵심 화면 UI 현대화 리디자인 (Clean SaaS, shadcn 기반)
- [x] E1-S4 User Story: 사용자는 오래된 인상의 화면이 아닌 현대적인 정보 위계와 가독성을 갖춘 대시보드에서 더 빠르게 입력/확인/재시도를 수행할 수 있어야 한다.
- [x] E1-S4 범위: Blue-Slate 토큰 재정의(`background/card/border/muted/primary`) 및 타이포/간격/보더/쉐도우 통일
- [x] E1-S4 범위: 대시보드 헤더 단순화, 좌측 히스토리/우측 작업영역 우선순위 재조정, 모바일 `Sheet` 동선 개선
- [x] E1-S4 범위: 입력 패널/히스토리/결과 카드/상태 컴포넌트의 시각 언어 일관화 및 150~220ms 미세 전환 적용
- [x] E1-S4 AC: 라이트 모드에서 텍스트 대비와 카드 계층이 명확하고, 다크 모드 호환이 유지된다.
- [x] E1-S4 AC: 데스크톱/태블릿/모바일에서 레이아웃 깨짐 없이 동일한 인터랙션 흐름을 제공한다.
- [x] E1-S4 AC: `pnpm lint` 및 `pnpm build` 기준 회귀 없이 빌드 통과한다.

### Epic 2: 핵심 기능 (Core Features) - 요약 엔진 및 결과 저장

- [x] 목표: UI에 Gemini API를 연동하여 요약을 수행하고, 결과를 데이터베이스에 저장하는 전체 파이프라인 구축
- [x] 예상 스토리 수: 4

#### Epic 2 체크리스트

- [x] E2-S1: 요약 데이터 모델/저장소 계층 구축
- [x] E2-S1 User Story: 시스템은 요약 요청과 처리 상태를 일관된 스키마로 저장하여 후속 조회와 상태 추적이 가능해야 한다.
- [x] E2-S1 범위: `summaries` 테이블 스키마 확정(`source_type`, `original_content`, `summary_text`, `status`, `created_at`)
- [x] E2-S1 범위: Drizzle 스키마/마이그레이션 작성
- [x] E2-S1 범위: 저장/조회용 Repository 함수(`createSummary`, `getSummaryById`, 상태 업데이트 계열 함수) 정의
- [x] E2-S1 AC: 요약 요청 생성 시 `pending` 상태 레코드가 DB(또는 메모리 스토어) 저장된다.
- [x] E2-S1 AC: 완료/실패 시 동일 레코드의 `status`, `summary_text`가 업데이트된다.
- [x] E2-S1 AC: 저장소 함수는 타입 안전(Type-safe)하게 컴파일되며 반환 타입이 명시된다.
- [x] E2-S1 AC: 마이그레이션 적용 후 DB에서 CRUD 기본 검증이 가능하다. (`pnpm db:crud-check`)

- [x] E2-S2: Gemini 요약 서비스 모듈 구현
- [x] E2-S2 User Story: 사용자가 입력한 텍스트/YouTube URL을 기반으로 시스템이 안정적으로 요약 결과를 생성할 수 있어야 한다.
- [x] E2-S2 범위: `lib/gemini`에 입력 타입별 요약 함수 구현
- [x] E2-S2 범위: 공통 프롬프트 템플릿(요약 길이/톤/구조) 정의
- [x] E2-S2 범위: 타임아웃/예외 처리를 포함한 API 호출 래퍼 작성
- [x] E2-S2 AC: 텍스트와 YouTube URL 모두 단일 서비스 인터페이스로 처리된다.
- [x] E2-S2 AC: Gemini 호출 실패 시 표준화된 에러 객체를 반환한다.
- [x] E2-S2 AC: 정상 응답 시 TL;DR + 본문 형태의 요약 문자열이 생성된다.
- [x] E2-S2 AC: 환경 변수 누락/잘못된 키 설정 시 개발 환경에서 원인 파악 가능한 로그가 남는다.

- [x] E2-S3: `/api/summary` 엔드포인트 및 처리 파이프라인 구현
- [x] E2-S3 User Story: 사용자가 요약 요청을 전송하면 서버가 요청을 검증하고 요약/저장 파이프라인을 실행한 뒤 일관된 응답을 반환해야 한다.
- [x] E2-S3 범위: `POST /api/summary` 엔드포인트 구현(입력 검증 포함)
- [x] E2-S3 범위: 요청 -> `pending` 저장 -> 작업 큐 등록 -> 워커 처리(`completed/failed`) 흐름 구성
- [x] E2-S3 범위: `GET /api/summaries/[id]` 상태 조회 엔드포인트 추가(폴링용)
- [x] E2-S3 추가 반영: YouTube URL 정규화/검증 로직 고도화(다양한 도메인/경로 지원)
- [x] E2-S3 범위: API 응답 포맷(`id`, `status`, `summary`) 표준화 (`POST /api/summary`, `GET /api/summaries/[id]`)
- [x] E2-S3 AC: 유효하지 않은 입력에 대해 4xx 응답과 명확한 오류 메시지를 반환한다.
- [x] E2-S3 AC: 정상 입력에 대해 저장된 레코드 식별자와 요약 필드(`summary`: 대기 중 `null`, 완료 시 요약 텍스트)를 즉시 반환한다.
- [x] E2-S3 AC: 처리 중 오류 발생 시 DB 상태가 `failed`로 기록된다(재시도 한도 초과 시 최종 실패).
- [x] E2-S3 AC: 동일 입력 타입(Text/YouTube)이 동일 엔드포인트에서 처리된다.
- [x] E2-S3 AC: 현재 구현은 `202 pending` 응답 후 폴링으로 최종 요약을 수신한다.
- [x] E2-S3 AC: 비동기 `202 + polling` 방식이 공식 동작으로 문서화되어 운영 기준이 일치한다.

- [x] E2-S4: 프론트엔드 연동 및 상태 피드백 완성
- [x] E2-S4 User Story: 사용자는 요약 요청 후 진행 상태와 결과를 명확히 확인할 수 있어야 하며, 실패 시 재시도를 시도할 수 있어야 한다.
- [x] E2-S4 범위: 입력 패널과 `/api/summary` 연동(Submit 핸들러)
- [x] E2-S4 범위: 요청 중 버튼 비활성화/로딩 인디케이터 처리
- [x] E2-S4 범위: 성공 시 결과 카드 갱신, 실패 시 오류 메시지와 재시도 UX 제공
- [x] E2-S4 범위: `GET /api/summaries/[id]` 폴링 훅 연동으로 비동기 상태 동기화
- [x] E2-S4 범위: 토스트 메시지(Toast)를 활용한 상태 알림
- [x] E2-S4 AC: 요청 중 중복 제출이 방지된다.
- [x] E2-S4 AC: 성공 시 최신 요약이 결과 카드에 즉시 반영된다(대기 -> 완료 상태 전환 포함).
- [x] E2-S4 AC: 실패 시 사용자가 원인을 이해할 수 있는 오류 메시지가 표시된다.
- [x] E2-S4 AC: 실패 후 입력값 보존 상태에서 재요청이 가능하다.

### Epic 3: 인증 및 계정 관리 (히스토리)

- [x] 목표: 사용자 식별(Supabase) 및 개인별 저장된 요약 히스토리 조회/관리 기능 구현
- [x] 예상 스토리 수: 3

#### Epic 3 사전 준비 상태

- [x] Google Cloud Console OAuth 설정 및 활성화 완료
- [x] Supabase OAuth Provider 설정 및 활성화 완료

#### Epic 3 체크리스트 (개발 계획)

- [x] E3-S1: 인증 경로 정비 및 Protected Routes 강화
- [x] E3-S1 User Story: 비로그인 사용자는 보호된 화면/API에 접근할 수 없고, 로그인 완료 후 원래 요청 위치로 복귀할 수 있어야 한다.
- [x] E3-S1 범위: `middleware.ts`를 Next.js 16 권장 `proxy.ts`로 전환
- [x] E3-S1 범위: 보호 페이지(`dashboard`, 요약 상세) 및 보호 API 접근 제어(401/redirect) 규칙 정리
- [x] E3-S1 범위: `/login?next=...` 리다이렉트 흐름(오픈 리다이렉트 방지 포함) 검증
- [x] E3-S1 범위: 로그인 상태에서 `/login` 접근 시 `next` 또는 기본 경로로 자동 이동
- [x] E3-S1 AC: 비로그인 상태에서 보호 경로 접근 시 `/login`으로 이동한다.
- [x] E3-S1 AC: 로그인 성공 후 요청했던 경로로 정상 복귀한다.
- [x] E3-S1 AC: 인증 없는 보호 API 호출은 일관된 401 응답을 반환한다.

- [x] E3-S2: 계정 초기화 및 사용자 프로필 조회 안정화
- [x] E3-S2 User Story: 신규 사용자는 첫 로그인 시 기본 크레딧을 지급받고, 이후 세션에서 자신의 계정 정보를 안정적으로 조회할 수 있어야 한다.
- [x] E3-S2 범위: OAuth callback 시 사용자 `upsert` 및 신규 사용자 `credits=3` 보장 로직 정리
- [x] E3-S2 범위: 서버 공통 사용자 식별 로직(`resolveApiUser`) 유틸화로 API 중복 제거
- [x] E3-S2 범위: 대시보드 계정 영역에 실제 사용자 정보(Supabase 세션 기반) 연동
- [x] E3-S2 범위: 로그인 공급자 UI를 Google 단일 정책으로 정리
- [x] E3-S2 AC: 신규 로그인 사용자는 `users` 레코드가 1회 생성되고 크레딧 3이 설정된다.
- [x] E3-S2 AC: 재로그인 시 중복 생성 없이 이메일/업데이트 시간만 갱신된다.
- [x] E3-S2 AC: 대시보드에서 로그인 사용자 정보가 계정 영역에 표시된다.

- [x] E3-S3: 개인 히스토리 조회/관리 완성
- [x] E3-S3 User Story: 사용자는 본인 히스토리만 날짜 기준으로 조회하고, 필요 시 개별/전체 관리(취소·삭제)를 수행할 수 있어야 한다.
- [x] E3-S3 범위: `GET /api/summaries`, `GET /api/summaries/[id]`, `POST /api/summaries/[id]/cancel`, `DELETE /api/summaries` 사용자 스코프 검증 강화
- [x] E3-S3 범위: 좌측 사이드바 히스토리 날짜 그룹 UX 정리 및 빈 상태/오류 상태 개선
- [x] E3-S3 범위: 전체삭제 모달 동작(취소/확인/로딩/완료 토스트) 마감 품질 점검
- [x] E3-S3 범위: 로고 클릭 초기화, 새 요약 시작, 히스토리 선택 전환 등 상태 동기화 회귀 점검
- [x] E3-S3 AC: 다른 사용자 요약 ID 접근 시 조회/취소/삭제가 거부된다.
- [x] E3-S3 AC: 히스토리 전체삭제 후 목록/선택/상태 UI가 일관되게 초기화된다.
- [x] E3-S3 AC: 히스토리가 많은 경우에도 날짜 구분/제목/상태 표시가 깨지지 않는다.

#### Epic 3 검증 계획

- [x] 단위 테스트: auth 유틸(`next` sanitize, user resolve), 사용자 upsert/credits 기본값 검증
- [x] API 테스트: `/api/summaries*` 사용자 격리/401/404 케이스 검증
- [x] 통합 시나리오: 비로그인 접근 차단 -> OAuth 로그인 -> 요약 생성 -> 히스토리 조회/전체삭제
- [x] 품질 게이트: `pnpm test`, `pnpm lint`, `pnpm build` 통과

### Epic 4: 결제 시스템 (수익화)

**목표**: 글로벌 결제(Stripe)를 연동하여 크레딧 패키지 구매 및 자동 충전 시스템을 구축

- [ ] **Story 4.1: Stripe 프로젝트 생성 및 MCP 연동**
  - [x] Stripe API 키/Price ID/Webhook Secret 환경변수 스키마 구성
  - [x] Stripe MCP Endpoint 연결 설정 (`.cursor/mcp.json`)
  - [x] Stripe 3가지 크레딧 패키지 Product/Price 동기화(`$5/30, $8/50, $15/100`) 운영 검증
  - [x] `lookup_key`(고정 식별자) 기반 idempotent 동기화 규칙 운영 검증
  - [x] Webhook Secret 기반 서명 검증 로직 구현
  - [ ] Stripe 대시보드 Webhook Endpoint 등록/Secret 발급 완료 여부 운영 검증
- [x] **Story 4.2: 결제 UI 및 Checkout 세션 생성**
  - [x] 사용자 대시보드 내 `충전하기` 모달 UI 구현
  - [x] 패키지 선택 시 Stripe Checkout Session 생성 API 구현 (`POST /api/payments/checkout`)
  - [x] Stripe 결제 페이지 리다이렉션 및 `metadata`에 사용자 ID/패키지/크레딧 정보 주입
- [x] **Story 4.3: Webhook 처리 및 크레딧 지급 로직**
  - [x] Next.js API Route (`/api/webhooks/stripe`) 생성 및 원본(Raw) Body 파싱 설정
  - [x] `checkout.session.completed` 이벤트 수신 시 서명 검증
  - [x] 검증 성공 시 `users` 크레딧 업데이트 + webhook 이벤트 idempotency 처리 (`stripe_event_id` unique)
- [x] **Story 4.4: 결제 피드백 및 예외 처리**
  - [x] 결제 성공 (`success_url`) 및 취소 (`cancel_url`) 상태 처리 (`/dashboard?payment=...`)
  - [x] 결제 성공 시 실시간 토스트 알림 및 크레딧 UI 갱신
  - [x] Webhook 처리 실패 시 오류 응답(재시도 유도) 및 결제 이벤트/트랜잭션 로그 기록

### Epic 5: 알림 및 이메일 서비스

- [ ] 목표: 요약 완료 이메일(Resend) 발송 및 전체적인 UX 폴리싱
- [ ] 예상 스토리 수: 2

---

## 범위 외 (Out of Scope)

### 현재 버전에서 제외되는 기능

- **파일 업로드**: 초기 MVP에서는 텍스트 직접 입력과 URL 입력만 지원
- **모바일 네이티브 앱**: 초기에는 반응형 웹에 집중
- **실시간 영상 자막 추출**: AI 모델이 처리 가능한 범위 내에서만 영상 요약 지원 (별도 STT 엔진 미사용)
- **커뮤니티 기능**: 다른 사용자의 요약을 보거나 공유하는 소셜 기능 제외
- **Hwp/Docx 파일 파싱**: 파일 업로드 기능 제외로 인해 불필요

### 지원하지 않는 플랫폼

- Internet Explorer 등 레거시 브라우저

### 기술적 제약

- AI 모델의 토큰 제한(Context Window)을 초과하는 초대용량 텍스트는 지원 불가할 수 있음
- 비공개 YouTube 영상은 요약 불가
